---
title: "Automated Weather Forecasting"
excerpt: "Something that has interested me for a while is how code can be used to generate media. Specifically, photos and video that is dynamic and can be generated via an API or some other trigger. It has really interested me and I am constantly thinking that this is the future of content"
coverImage: "/images/blog/automated-weather-forecasting-cover.png"
date: "2022-05-04T14:28:42.277Z"
ogImage:
    url: "/images/default.jpg"
minsRead: 6
---

Something that has interested me for a while is how code can be used to generate media. Specifically, photos and video that is dynamic and can be generated via an API or some other trigger. It has interested me and I am constantly thinking that this is the future of content. For example adverts that generate themselves on the fly specific to users too, to show users names or something (like **Jack, you have to check out these products...**).

A while ago I used to be quite involved with the popular football game FIFA. During the COVID pandemic lockdown, me and a couple of friends started doing a league on the popular chat app Discord. I was in charge of administrative tasks like adding roles to people. In the community, it was commonplace for players to be assigned to teams by roles when managers signed them. I ended up coding a Discord bot that did this automatically and it worked really well. FIFA has a popular game mode called Ultimate Team where each player has a card with their stats on it. This inspired me and I brought this functionality to the bot where each player could log in with Discord on our website and customise their card. Players could then get their cards as an image in Discord by typing `!card` or something like that. It was a really cool concept that used HTML to render the cards and then take an image of it, then send it as a message. (The popular Discord bot [MEE6](https://mee6.xyz) has a similar feature with activity cards).

![Futwiz Website](/images/blog/automated-weather-forecasting-img1.png)
_A screenshot of [Futwiz](https://futwiz.com), and their service which lets you create a custom FIFA Ultimate Team card. This is similar to what my website was as I don't have the original code or a screenshot to hand._

<br />

So, I have always craved a new project that generates media. I came across this amazing Node JS library called [Remotion](https://www.remotion.dev) while watching a [Fireship](https://www.youtube.com/watch?v=deg8bOoziaE) video. It really inspired me to create something with dynamic data. The first thing I could think of was a weather forecast system (even though Jeff did this in his video sort of). One of the other features I wanted to add was an automatic upload so it would render the video and then upload it to a social media platform. I began working on it.

### How I did it

My experience with the library (or framework I don't know what to call it) has been really positive. It is basically just React and it has lots of built-in components to handle things like separating video into sections and animations. I really found it easy to go from a Figma design to the actual thing. I coded it in such a way that the components would be reused and dynamically generated.

With the React code ready, the next bit was the data side. While there are lots of weather APIs out there, I decided to go with a trusted source in the UK, the MET Office. I used their [DataPoint](https://www.metoffice.gov.uk/services/data/datapoint) service. This is where the hair-tearing out begins. The documentation is not very clear and I found it very confusing. The API looks like it was written ages ago as many common practises just did not exist. (Like for example specifying what type the data was in the URL. That should be in the `Content-Type` header). I eventually managed to get it pulling the data I needed and implemented it into the code. As of writing this I have realised they have another service called [DataPoint](https://www.metoffice.gov.uk/services/data/met-office-weather-datahub) which might be better as DataPoint is apparently deprecated and getting 'switched off' soon. I might have a look at upgrading it soon. Another issue I had was with the way Remotion works, it would pull data from the API from each frame and considering there was something like 4,000 frames it was really slow. Luckily, I came up with a solution of using the `localStorage` api to cache the data.

Now, finally it was generating the videos properly with the proper data. You can check the code at this repository [here](https://github.com/JackHumphries9/weather-forecaster).

The next challenge was uploading the exported video to social media platforms. The whole idea of the video was to be viewed on a phone (as it had the resolution of `1080x1920` which is standard for most fullscreen vertical content). I was targeting social media platforms which had this feature of videos vertically such as TikTok, Instagram and YouTube. First, I tried the TikTok API. This proved to not be a viable solution because as of writing this their API supports uploading the video but doesn't allow you to publish it as you need to do this from the app. This would eliminate the automated nature of what I was trying to achieve. Next, for Instagram I was targing Instagram Reels. Again, this was possible but the way Instagram handles file uploads is not what I had in mind. You have to host your media and point Instagram to that URL so it can pull the video from that source instead of uploading it as data. This is possible and I already have some ideas for this with CDN's and such.

Finally, third time lucky I researched YouTube API uploads. I knew YouTube had some good API's as is the case with all Google Products. However, I had no experience with interacting with Google's services and OAuth2. After messing about with service accounts and getting nowhere, I learnt that I needed to use OAuth2 and just generate an access token for my service. The script (which, I won't lie, was copied from the documentation with some modifications made by me), checks to see if there is an access token and if there isn't it will fetch a link to login with a YouTube channel. After all that, it will then upload the video with all the metadata and title generated. You can check the source code out for this [here](https://github.com/JackHumphries9/weatherforecast-upload-cli).Finally, we get a YouTube video which is uploaded.

The final piece of the puzzle was deploying this software/app/thing. I am using an Ubuntu server on [Digital Ocean](https://www.digitalocean.com). This has Node, Chrome and FFMPEG for Remotion to work. To finish it off, there is also a cronjob which runs at 12pm everyday to generate the weather forecast for the following day.

And yeah that's the full story. It's a bit long this article but thanks for sticking with it. I have really enjoyed working on this project because it's required a lot of different skills and is quite unique and different. Hopefully you enjoyed reading as much as I have enjoyed this whole project. I will continue to develop this and I have plans to add Instagram support as well as maybe do some other countries other than the UK
